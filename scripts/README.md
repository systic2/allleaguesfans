# Scripts ë””ë ‰í† ë¦¬ ê°œìš”

ì´ ë””ë ‰í† ë¦¬ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë°ì´í„° ë™ê¸°í™”, ë§ˆì´ê·¸ë ˆì´ì…˜, ìœ í‹¸ë¦¬í‹° ê¸°ëŠ¥ ë“±ì„ ë‹´ë‹¹í•˜ëŠ” ë‹¤ì–‘í•œ ìŠ¤í¬ë¦½íŠ¸ë“¤ì„ í¬í•¨í•©ë‹ˆë‹¤. ìŠ¤í¬ë¦½íŠ¸ì˜ ëª©ì ê³¼ ì‚¬ìš© íŒ¨í„´ì— ë”°ë¼ ë‹¤ìŒê³¼ ê°™ì´ ë¶„ë¥˜ë©ë‹ˆë‹¤.

---

## ğŸ“ `sync/`
ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í•µì‹¬ ë°ì´í„° ë™ê¸°í™” ë¡œì§ì„ í¬í•¨í•˜ëŠ” ë””ë ‰í† ë¦¬ì…ë‹ˆë‹¤. ì™¸ë¶€ API (TheSportsDB, Highlightly, K League API ë“±)ë¡œë¶€í„° ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ Supabase ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ë“¤ì´ ìœ„ì¹˜í•©ë‹ˆë‹¤.

### ì£¼ìš” ìŠ¤í¬ë¦½íŠ¸:
*   `orchestrator.ts`: ìƒˆë¡œìš´ í‘œì¤€í™”ëœ ë°ì´í„° ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ” ë©”ì¸ ë™ê¸°í™” ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤. `standings_v2`ì™€ `events_v2` í…Œì´ë¸”ì— ë°ì´í„°ë¥¼ ë™ê¸°í™”í•©ë‹ˆë‹¤.
*   `sync-highlightly-correct.ts`: Highlightly APIë¡œë¶€í„° ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ ì²˜ë¦¬í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ (ì¶”ì •).
*   `sync-all-player-stats.ts`: ëª¨ë“  í”Œë ˆì´ì–´ í†µê³„ë¥¼ ë™ê¸°í™”í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ (ì¶”ì •).
*   `sync-k1-player-stats.ts`, `sync-k2-player-stats.ts`, `sync-k2-player-stats-direct.ts`: Kë¦¬ê·¸ 1 ë° 2ì˜ í”Œë ˆì´ì–´ í†µê³„ ê´€ë ¨ ë™ê¸°í™” ìŠ¤í¬ë¦½íŠ¸.
*   `sync-player-statistics.ts`: ì¼ë°˜ì ì¸ í”Œë ˆì´ì–´ í†µê³„ ë™ê¸°í™” ìŠ¤í¬ë¦½íŠ¸.
*   `sync-player-stats-direct.ts`, `sync-player-stats-from-db.ts`, `sync-player-stats-from-highlightly.ts`, `sync-player-stats-from-thesportsdb.ts`: ë‹¤ì–‘í•œ ì†ŒìŠ¤ì—ì„œ í”Œë ˆì´ì–´ í†µê³„ë¥¼ ê°€ì ¸ì˜¤ëŠ” ìŠ¤í¬ë¦½íŠ¸.
*   `02-thesportsdb-api-integration.ts`, `03-highlightly-api-sync.ts`, `3api-data-import.ts`: API í†µí•© ë° ë°ì´í„° ì„í¬íŠ¸ ê´€ë ¨ ìŠ¤í¬ë¦½íŠ¸.
*   `import-historical-standings.ts`, `import-team-players.ts`: ê³¼ê±° ë°ì´í„° ë° íŒ€/ì„ ìˆ˜ ë°ì´í„° ì„í¬íŠ¸ ê´€ë ¨ ìŠ¤í¬ë¦½íŠ¸.
*   `cron-sync.sh`: ë™ê¸°í™” ìŠ¤í¬ë¦½íŠ¸ë“¤ì„ ì£¼ê¸°ì ìœ¼ë¡œ ì‹¤í–‰í•˜ê¸° ìœ„í•œ ì‰˜ ìŠ¤í¬ë¦½íŠ¸.
*   `lib/`: ë™ê¸°í™” ìŠ¤í¬ë¦½íŠ¸ë“¤ì—ì„œ ê³µìœ í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ìœ í‹¸ë¦¬í‹° ì½”ë“œ.

### ì‹¤í–‰ ë°©ë²• (ì˜ˆì‹œ):
```bash
# ìƒˆë¡œìš´ ì¡°ìœ¨ì ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
npx tsx scripts/sync/orchestrator.ts
```

---

## ğŸ“ `migrations/`
ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì •ì˜, ë³€ê²½ ë° ë§ˆì´ê·¸ë ˆì´ì…˜ê³¼ ê´€ë ¨ëœ SQL ìŠ¤í¬ë¦½íŠ¸ë“¤ì´ ìœ„ì¹˜í•©ë‹ˆë‹¤.

### ì£¼ìš” ìŠ¤í¬ë¦½íŠ¸:
*   `01-create-league-id-mapping.sql`, `01-create-thesportsdb-foundation-schema.sql`, `02-create-highlightly-enhanced-schema.sql`, `03-create-player-statistics-schema.sql`: ì´ˆê¸° ìŠ¤í‚¤ë§ˆ ìƒì„± ë° ê¸°ì´ˆ í…Œì´ë¸” ì„¤ì •.
*   `04-create-standings-v2-schema.sql`: ìƒˆë¡œìš´ í‘œì¤€í™”ëœ ìˆœìœ„ ì •ë³´ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•œ `standings_v2` í…Œì´ë¸”ì„ ìƒì„±í•©ë‹ˆë‹¤.
*   `05-drop-old-standings-table.sql`: ë” ì´ìƒ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” `standings` í…Œì´ë¸”ì„ ì‚­ì œí•©ë‹ˆë‹¤.
*   `08-recreate-highlightly-dependencies.sql`: ì˜¤ë˜ëœ events ê´€ë ¨ ê°ì²´ë“¤ì„ ì •ë¦¬í•˜ê³ , events_v2ì— ë§ì¶° ì˜ì¡´ì„±ì„ ë‹¤ì‹œ ìƒì„±í•©ë‹ˆë‹¤.
*   `add-highlightly-column-to-events.sql`: ì´ë²¤íŠ¸ í…Œì´ë¸”ì— Highlightly ê´€ë ¨ ì»¬ëŸ¼ ì¶”ê°€.
*   `create-upsert-player-stats-function.sql`: í”Œë ˆì´ì–´ í†µê³„ upsert í•¨ìˆ˜ ìƒì„±.
*   `force-recreate-player-stats.sql`: í”Œë ˆì´ì–´ í†µê³„ í…Œì´ë¸” ê°•ì œ ì¬êµ¬ì„±.
*   `reload-postgrest-schema.sql`: PostgREST ìŠ¤í‚¤ë§ˆ ì¬ë¡œë”©.
*   `reset-and-setup-player-stats.sql`: í”Œë ˆì´ì–´ í†µê³„ ì¬ì„¤ì • ë° ì„¤ì •.
*   `update-player-stats-rls.sql`: Row Level Security (RLS) ì—…ë°ì´íŠ¸.

### ì‚¬ìš© ë°©ë²• (ì˜ˆì‹œ):
Supabase CLI ë˜ëŠ” ë‹¤ë¥¸ ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.
```bash
# Supabase CLIë¥¼ í†µí•´ ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰
supabase migration up
# ë˜ëŠ” ìˆ˜ë™ìœ¼ë¡œ SQL ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
psql -f scripts/migrations/07-drop-old-events-table.sql
```

---

## ğŸ“ `one-off/`
íŠ¹ì • ì¡°ê±´ í™•ì¸, ë””ë²„ê¹…, ì¼íšŒì„± ë°ì´í„° ì¡°ì •, ë˜ëŠ” íŠ¹ì • ë¶„ì„ì„ ìœ„í•œ ìŠ¤í¬ë¦½íŠ¸ë“¤ì´ ìœ„ì¹˜í•©ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ì£¼ê¸°ì ìœ¼ë¡œ ì‹¤í–‰ë˜ê±°ë‚˜ í•µì‹¬ì ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œì§ì˜ ì¼ë¶€ëŠ” ì•„ë‹™ë‹ˆë‹¤.

### ì£¼ìš” ìŠ¤í¬ë¦½íŠ¸ (ì˜ˆì‹œ):
*   `check-*`: ë°ì´í„° ìœ íš¨ì„±, ìŠ¤í‚¤ë§ˆ ì¼ì¹˜ ì—¬ë¶€ ë“± ë‹¤ì–‘í•œ ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.
*   `debug-*`: íŠ¹ì • ë°ì´í„° ë¬¸ì œë‚˜ ë¡œì§ì„ ë””ë²„ê¹…í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤.
*   `fetch-*`: íŠ¹ì • ë°ì´í„°ë¥¼ ì¼íšŒì„±ìœ¼ë¡œ ê°€ì ¸ì˜¤ëŠ” ìŠ¤í¬ë¦½íŠ¸.
*   `test-*`: íŠ¹ì • ê¸°ëŠ¥ì˜ ë™ì‘ì„ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤.
*   `verify-*`: ë°ì´í„°ì˜ ì •í™•ì„±ì„ ê²€ì¦í•©ë‹ˆë‹¤.
*   `git-branch-cleanup.ts`, `git-manual-cleanup.sh`: Git ë¸Œëœì¹˜ ì •ë¦¬ ìœ í‹¸ë¦¬í‹°.
*   `highlightly-integration-plan.md`: Highlightly í†µí•© ê´€ë ¨ ê³„íš ë¬¸ì„œ.

### ì‚¬ìš© ë°©ë²• (ì˜ˆì‹œ):
```bash
# íŠ¹ì • ë°ì´í„° í™•ì¸
npx tsx scripts/one-off/check-k1-data.ts
# ë””ë²„ê¹… ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
npx tsx scripts/one-off/debug-yago-assist.ts
```

---

## ğŸ“ `archive/`
í˜„ì¬ í”„ë¡œì íŠ¸ì—ì„œ ë” ì´ìƒ ì‚¬ìš©ë˜ì§€ ì•Šê±°ë‚˜, ê¸°ëŠ¥ì´ ëŒ€ì²´ëœ ë ˆê±°ì‹œ ìŠ¤í¬ë¦½íŠ¸ë“¤ì´ ë³´ê´€ë˜ëŠ” ë””ë ‰í† ë¦¬ì…ë‹ˆë‹¤. í–¥í›„ ì°¸ì¡°ë¥¼ ìœ„í•´ ë³´ê´€í•˜ì§€ë§Œ, ì§ì ‘ ì‹¤í–‰ë˜ì§€ ì•Šì•„ì•¼ í•©ë‹ˆë‹¤.

### ì£¼ìš” ìŠ¤í¬ë¦½íŠ¸ (ì˜ˆì‹œ):
*   `03-thesportsdb-integration-fixed.ts`: ì´ì „ ë²„ì „ì˜ TheSportsDB í†µí•© ìŠ¤í¬ë¦½íŠ¸.

---